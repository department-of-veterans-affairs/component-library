@forward 'uswds-theme';

@use 'uswds-core/src/styles/mixins/utility-builder' as *;
@use 'uswds-core/src/styles/functions' as *;
@use '../utilities' as *;

$utilities-package: map-collect(
  $u-bg-color,
  $u-border,
  $u-color,
  $u-display,
  $u-flex-grid,
  $u-flexbox,
  $u-font,
  $u-height,
  $u-line-height,
  $u-margin,
  $u-measure,
  $u-padding,
  $u-position,
  $u-text-align,
  $u-text-decoration,
  $u-visibility,
  $u-width
);

// Generate all utility classes
@include render-utilities-in($utilities-package);

/**
  * Generate custom breakpoint utility classes. ie. medium-screen
  */
$medium-screen-breakpoint: 768px;
$breakpoint-class-name: 'medium-screen';

@mixin generate-utilities-from-map-collection($collection) {
  @each $property, $property-map in $collection { 
    $u-base: map-get($property-map, base);
    $u-values: map-get($property-map, values);
    $u-property: map-get($property-map, property);

    @each $name, $value in $u-values {
      .#{$breakpoint-class-name}\:#{$u-base}-#{$name} {
        #{$u-property}: $value;
      }
    }
  }
}

@media all and (min-width: $medium-screen-breakpoint) {
  // border
  $u-border-modifiers: map-get(map-get($u-border, border), modifiers);
  $u-border-values: map-get(map-get($u-border, border), values);
  $u-border-base: map-get(map-get($u-border, border), base);

  @each $modifier, $modifier-value in $u-border-modifiers {
    @each $name, $value in $u-border-values {
      .#{$breakpoint-class-name}\:#{$u-border-base}#{$modifier-value}-#{$name} {
        @if $modifier == 'noModifier' {
          border: unquote($value);
        } @else {
          border#{$modifier-value}: unquote($value);
        }
      }
    }
  }

  // display
  $u-display-values: map-get(map-get($u-display, display), values);
  $u-display-base: map-get(map-get($u-display, display), base);

  @each $name, $value in $u-display-values {
    .#{$breakpoint-class-name}\:#{$u-display-base}-#{$name} {
      display: unquote($value);
    }
  }

  // flexbox
  @include generate-utilities-from-map-collection($u-flexbox);

  // font-size
  @include generate-utilities-from-map-collection($u-font);
}
